<UserControl x:Class="SchoolManagementSystem.UI.UI.Views.Library.BookInventoryPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Background="#F5F6FA">

    <Grid Margin="25">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header (if used) -->
            <RowDefinition Height="Auto"/>
            <!-- Toolbar -->
            <RowDefinition Height="Auto"/>
            <!-- KPI -->
            <RowDefinition Height="*"/>
            <!-- DataGrid -->
        </Grid.RowDefinitions>


        <!-- ================= HEADER ================= 
        <StackPanel Grid.Row="0" Margin="0,0,0,20">

            <TextBlock Text="Library Book Inventory"
                       FontSize="22"
                       FontWeight="SemiBold"
                       Foreground="#2C3E50"/>

            <TextBlock Text="Manage books, availability and stock"
                       FontSize="12"
                       Foreground="Gray"/>
        </StackPanel>-->

        <!-- ================= TOOLBAR ================= -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box -->
            <TextBox Grid.Column="0"
             Width="350"
             Height="36"
             Padding="10,6"
             FontSize="11"
             HorizontalAlignment="Left"
             materialDesign:HintAssist.Hint="Search by Title, Author or Code"
             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
             Style="{StaticResource MaterialDesignOutlinedTextBox}" />

            <!-- Add Button -->
            <Button Grid.Column="1"
            Content=" + Add Book"
            Height="36"
            Padding="20,0"
            Margin="15,0,0,0"
            HorizontalAlignment="Right"
            Command="{Binding AddBookCommand}"
            Background="#1976D2"
            Foreground="White"
            FontWeight="SemiBold"/>
        </Grid>


        <!-- ================= KPI CARDS ================= -->
        <Grid Grid.Row="2" Margin="0,0,0,15">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <materialDesign:Card Grid.Column="0" Margin="6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Total Books" Foreground="Gray" FontSize="11"/>
                    <TextBlock Text="{Binding TotalBooks}"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#1976D2"/>
                </StackPanel>
            </materialDesign:Card>

            <materialDesign:Card Grid.Column="1" Margin="6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Total Copies" Foreground="Gray" FontSize="11"/>
                    <TextBlock Text="{Binding TotalCopies}"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#2E7D32"/>
                </StackPanel>
            </materialDesign:Card>

            <materialDesign:Card Grid.Column="2" Margin="6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Available" Foreground="Gray" FontSize="11"/>
                    <TextBlock Text="{Binding AvailableCopies}"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#43A047"/>
                </StackPanel>
            </materialDesign:Card>

            <materialDesign:Card Grid.Column="3" Margin="6" Padding="12">
                <StackPanel>
                    <TextBlock Text="Issued" Foreground="Gray" FontSize="11"/>
                    <TextBlock Text="{Binding IssuedCopies}"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#D32F2F"/>
                </StackPanel>
            </materialDesign:Card>

        </Grid>

        <!-- ================= DATAGRID ================= -->
        <materialDesign:Card Grid.Row="3"
                     Padding="0"
                     Background="White"
                     Margin="0">


            <DataGrid ItemsSource="{Binding Books}"
              AutoGenerateColumns="False"
              IsReadOnly="True"
              CanUserAddRows="False"
              HeadersVisibility="Column"
              RowHeight="34"
              GridLinesVisibility="None"
              AlternatingRowBackground="#F9FAFB"
              BorderThickness="0"
              EnableRowVirtualization="True"
              EnableColumnVirtualization="True"
              ScrollViewer.VerticalScrollBarVisibility="Auto"
              ScrollViewer.CanContentScroll="True">
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="White"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Height" Value="34"/>

                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E3F2FD"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#BBDEFB"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>

                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="FontSize" Value="12"/>
                        <Setter Property="Foreground" Value="#2C3E50"/>
                        <Setter Property="Background" Value="#E8EDF3"/>
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="Height" Value="38"/>
                        <Setter Property="BorderBrush" Value="#D6DCE5"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="Padding" Value="5"/>
                    </Style>
                </DataGrid.CellStyle>
                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Background" Value="#E8EDF3"/>
                        <Setter Property="BorderBrush" Value="#D6DCE5"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="Padding" Value="5"/>

                        <Style.Triggers>
                            <Trigger Property="SortDirection" Value="Ascending">
                                <Setter Property="Foreground" Value="#1976D2"/>
                            </Trigger>
                            <Trigger Property="SortDirection" Value="Descending">
                                <Setter Property="Foreground" Value="#D32F2F"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Resources>

                <DataGrid.Columns>

                    <DataGridTextColumn Header="Code"
                    Binding="{Binding BookCode}"
                    Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="Title"
                    Binding="{Binding Title}"
                    Width="250">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Left"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Padding" Value="5,0,0,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="Author"
                    Binding="{Binding Author}"
                    Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>


                    <DataGridTextColumn Header="Category"
                                        Binding="{Binding Category}"
                                        Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Header="Total"
                    Binding="{Binding TotalCopies}"
                    Width="*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>


                    <DataGridTextColumn Header="Available"
                                        Binding="{Binding AvailableCopies}"
                                        Width="80">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Actions -->
                    <DataGridTemplateColumn Header="Actions" Width="200">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid VerticalAlignment="Stretch">

                                    <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Stretch">

                                        <Button Content="Edit"
                            MinWidth="75"
                            Margin="4,0"
                            VerticalAlignment="Stretch"
                            Background="#0288D1"
                            Foreground="White"
                            FontSize="11"
                            Command="{Binding DataContext.EditBookCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}" />

                                        <Button Content="Delete"
                            MinWidth="75"
                            Margin="4,0"
                            VerticalAlignment="Stretch"
                            Background="#E53935"
                            Foreground="White"
                            FontSize="11"
                            Command="{Binding DataContext.DeleteBookCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                            CommandParameter="{Binding}" />

                                    </StackPanel>

                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>


                </DataGrid.Columns>

            </DataGrid>

        </materialDesign:Card>

    </Grid>
</UserControl>
